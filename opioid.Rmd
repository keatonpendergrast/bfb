---
title: "opioid"
author: "Keaton Pendergrast"
date: "2/13/2020"
output: html_document
---

```{r}
## set libraries needed
require(tidyverse)
require(foreign)
require(funModeling)
require(Hmisc)
require(dplyr)
require(DataExplorer)
require(readr)
require(tikzDevice)
```

```{r}
#pull in the datasets

urlfile="https://media.githubusercontent.com/media/keatonpendergrast/bfb/master/2007.tsv"

seven <- read.table(url(urlfile), sep = '\t', header = TRUE)

urlfile="https://media.githubusercontent.com/media/keatonpendergrast/bfb/master/2008.tsv"

eight <- read.table(url(urlfile), sep = '\t', header = TRUE)

urlfile="https://media.githubusercontent.com/media/keatonpendergrast/bfb/master/2009.tsv"

nine <- read.table(url(urlfile), sep = '\t', header = TRUE)

urlfile="https://media.githubusercontent.com/media/keatonpendergrast/bfb/master/2010.csv"

ten <- read.csv(url(urlfile))

urlfile="https://media.githubusercontent.com/media/keatonpendergrast/bfb/master/2011.csv"

eleven <- read.csv(url(urlfile))

urlfile="https://media.githubusercontent.com/media/keatonpendergrast/bfb/master/2012.csv"

twelve <- read.csv(url(urlfile))

urlfile="https://media.githubusercontent.com/media/keatonpendergrast/bfb/master/2013.csv"

thirteen <- read.csv(url(urlfile))

urlfile="https://media.githubusercontent.com/media/keatonpendergrast/bfb/master/2014.csv"

fourteen <- read.csv(url(urlfile))

urlfile="https://media.githubusercontent.com/media/keatonpendergrast/bfb/master/2015.csv"

fifteen <- read.csv(url(urlfile))

urlfile="https://raw.githubusercontent.com/keatonpendergrast/bfb/master/2016.csv"

sixteen <- read.csv(url(urlfile))
```

```{r}
#select for the variables we are interested in
seven_clean <- seven %>%
  select(PHYCODE, PATCODE, SENBEFOR, RFV1, RFV2, RFV3, CONTSUB1, CONTSUB2, CONTSUB3, CONTSUB4, CONTSUB5, CONTSUB6, CONTSUB7, CONTSUB8, MED1, MED2, MED3, MED4, MED5, MED6, MED7, MED8, NCMED1, NCMED2, NCMED3, NCMED4, NCMED5, NCMED6, NCMED7, NCMED8) %>%
  filter(CONTSUB1 == "2" | CONTSUB1 == "3" | CONTSUB1 == "4" | CONTSUB1 == "5" | CONTSUB1 == "8" | CONTSUB2 == "2" | CONTSUB2 == "3" | CONTSUB2 == "4" | CONTSUB2 == "5" | CONTSUB2 == "8" | CONTSUB3 == "2" | CONTSUB3 == "3" | CONTSUB3 == "4" | CONTSUB3 == "5" | CONTSUB3 == "8" | CONTSUB4 == "2" | CONTSUB4 == "3" | CONTSUB4 == "4" | CONTSUB4 == "5" | CONTSUB4 == "8" | CONTSUB5 == "2" | CONTSUB5 == "3" | CONTSUB5 == "4" | CONTSUB5 == "5" | CONTSUB5 == "8" | CONTSUB6 == "2" | CONTSUB6 == "3" | CONTSUB6 == "4" | CONTSUB6 == "5" | CONTSUB6 == "8" | CONTSUB7 == "2" | CONTSUB7 == "3" | CONTSUB7 == "4" | CONTSUB7 == "5" | CONTSUB7 == "8" | CONTSUB8 == "2" | CONTSUB8 == "3" | CONTSUB8 == "4" | CONTSUB8 == "5" | CONTSUB8 == "8")
  

eight_clean <- eight %>%
  select(PHYCODE, PATCODE, SENBEFOR, RFV1, RFV2, RFV3, CONTSUB1, CONTSUB2, CONTSUB3, CONTSUB4, CONTSUB5, CONTSUB6, CONTSUB7, CONTSUB8, MED1, MED2, MED3, MED4, MED5, MED6, MED7, MED8, NCMED1, NCMED2, NCMED3, NCMED4, NCMED5, NCMED6, NCMED7, NCMED8) %>%
  filter(CONTSUB1 == "2" | CONTSUB1 == "3" | CONTSUB1 == "4" | CONTSUB1 == "5" | CONTSUB1 == "8" | CONTSUB2 == "2" | CONTSUB2 == "3" | CONTSUB2 == "4" | CONTSUB2 == "5" | CONTSUB2 == "8" | CONTSUB3 == "2" | CONTSUB3 == "3" | CONTSUB3 == "4" | CONTSUB3 == "5" | CONTSUB3 == "8" | CONTSUB4 == "2" | CONTSUB4 == "3" | CONTSUB4 == "4" | CONTSUB4 == "5" | CONTSUB4 == "8" | CONTSUB5 == "2" | CONTSUB5 == "3" | CONTSUB5 == "4" | CONTSUB5 == "5" | CONTSUB5 == "8" | CONTSUB6 == "2" | CONTSUB6 == "3" | CONTSUB6 == "4" | CONTSUB6 == "5" | CONTSUB6 == "8" | CONTSUB7 == "2" | CONTSUB7 == "3" | CONTSUB7 == "4" | CONTSUB7 == "5" | CONTSUB7 == "8" | CONTSUB8 == "2" | CONTSUB8 == "3" | CONTSUB8 == "4" | CONTSUB8 == "5" | CONTSUB8 == "8")

nine_clean <- nine %>%
  select(PHYCODE, PATCODE, SENBEFOR, RFV1, RFV2, RFV3, CONTSUB1, CONTSUB2, CONTSUB3, CONTSUB4, CONTSUB5, CONTSUB6, CONTSUB7, CONTSUB8, MED1, MED2, MED3, MED4, MED5, MED6, MED7, MED8, NCMED1, NCMED2, NCMED3, NCMED4, NCMED5, NCMED6, NCMED7, NCMED8) %>%
  filter(CONTSUB1 == "2" | CONTSUB1 == "3" | CONTSUB1 == "4" | CONTSUB1 == "5" | CONTSUB1 == "8" | CONTSUB2 == "2" | CONTSUB2 == "3" | CONTSUB2 == "4" | CONTSUB2 == "5" | CONTSUB2 == "8" | CONTSUB3 == "2" | CONTSUB3 == "3" | CONTSUB3 == "4" | CONTSUB3 == "5" | CONTSUB3 == "8" | CONTSUB4 == "2" | CONTSUB4 == "3" | CONTSUB4 == "4" | CONTSUB4 == "5" | CONTSUB4 == "8" | CONTSUB5 == "2" | CONTSUB5 == "3" | CONTSUB5 == "4" | CONTSUB5 == "5" | CONTSUB5 == "8" | CONTSUB6 == "2" | CONTSUB6 == "3" | CONTSUB6 == "4" | CONTSUB6 == "5" | CONTSUB6 == "8" | CONTSUB7 == "2" | CONTSUB7 == "3" | CONTSUB7 == "4" | CONTSUB7 == "5" | CONTSUB7 == "8" | CONTSUB8 == "2" | CONTSUB8 == "3" | CONTSUB8 == "4" | CONTSUB8 == "5" | CONTSUB8 == "8")

ten_clean <- ten %>%
  select(PHYCODE, PATCODE, SENBEFOR, RFV1, RFV2, RFV3, CONTSUB1, CONTSUB2, CONTSUB3, CONTSUB4, CONTSUB5, CONTSUB6, CONTSUB7, CONTSUB8, MED1, MED2, MED3, MED4, MED5, MED6, MED7, MED8, NCMED1, NCMED2, NCMED3, NCMED4, NCMED5, NCMED6, NCMED7, NCMED8) %>%
  filter(CONTSUB1 == "2" | CONTSUB1 == "3" | CONTSUB1 == "4" | CONTSUB1 == "5" | CONTSUB1 == "8" | CONTSUB2 == "2" | CONTSUB2 == "3" | CONTSUB2 == "4" | CONTSUB2 == "5" | CONTSUB2 == "8" | CONTSUB3 == "2" | CONTSUB3 == "3" | CONTSUB3 == "4" | CONTSUB3 == "5" | CONTSUB3 == "8" | CONTSUB4 == "2" | CONTSUB4 == "3" | CONTSUB4 == "4" | CONTSUB4 == "5" | CONTSUB4 == "8" | CONTSUB5 == "2" | CONTSUB5 == "3" | CONTSUB5 == "4" | CONTSUB5 == "5" | CONTSUB5 == "8" | CONTSUB6 == "2" | CONTSUB6 == "3" | CONTSUB6 == "4" | CONTSUB6 == "5" | CONTSUB6 == "8" | CONTSUB7 == "2" | CONTSUB7 == "3" | CONTSUB7 == "4" | CONTSUB7 == "5" | CONTSUB7 == "8" | CONTSUB8 == "2" | CONTSUB8 == "3" | CONTSUB8 == "4" | CONTSUB8 == "5" | CONTSUB8 == "8")

eleven_clean <- eleven %>%
  select(PHYCODE, PATCODE, SENBEFOR, RFV1, RFV2, RFV3, CONTSUB1, CONTSUB2, CONTSUB3, CONTSUB4, CONTSUB5, CONTSUB6, CONTSUB7, CONTSUB8, MED1, MED2, MED3, MED4, MED5, MED6, MED7, MED8, NCMED1, NCMED2, NCMED3, NCMED4, NCMED5, NCMED6, NCMED7, NCMED8) %>%
  filter(CONTSUB1 == "2" | CONTSUB1 == "3" | CONTSUB1 == "4" | CONTSUB1 == "5" | CONTSUB1 == "8" | CONTSUB2 == "2" | CONTSUB2 == "3" | CONTSUB2 == "4" | CONTSUB2 == "5" | CONTSUB2 == "8" | CONTSUB3 == "2" | CONTSUB3 == "3" | CONTSUB3 == "4" | CONTSUB3 == "5" | CONTSUB3 == "8" | CONTSUB4 == "2" | CONTSUB4 == "3" | CONTSUB4 == "4" | CONTSUB4 == "5" | CONTSUB4 == "8" | CONTSUB5 == "2" | CONTSUB5 == "3" | CONTSUB5 == "4" | CONTSUB5 == "5" | CONTSUB5 == "8" | CONTSUB6 == "2" | CONTSUB6 == "3" | CONTSUB6 == "4" | CONTSUB6 == "5" | CONTSUB6 == "8" | CONTSUB7 == "2" | CONTSUB7 == "3" | CONTSUB7 == "4" | CONTSUB7 == "5" | CONTSUB7 == "8" | CONTSUB8 == "2" | CONTSUB8 == "3" | CONTSUB8 == "4" | CONTSUB8 == "5" | CONTSUB8 == "8")

twelve_clean <- twelve %>%
  select(PHYCODE, PATCODE, SENBEFOR, RFV1, RFV2, RFV3, CONTSUB1, CONTSUB2, CONTSUB3, CONTSUB4, CONTSUB5, CONTSUB6, CONTSUB7, CONTSUB8, MED1, MED2, MED3, MED4, MED5, MED6, MED7, MED8, NCMED1, NCMED2, NCMED3, NCMED4, NCMED5, NCMED6, NCMED7, NCMED8) %>%
  filter(CONTSUB1 == "2" | CONTSUB1 == "3" | CONTSUB1 == "4" | CONTSUB1 == "5" | CONTSUB1 == "8" | CONTSUB2 == "2" | CONTSUB2 == "3" | CONTSUB2 == "4" | CONTSUB2 == "5" | CONTSUB2 == "8" | CONTSUB3 == "2" | CONTSUB3 == "3" | CONTSUB3 == "4" | CONTSUB3 == "5" | CONTSUB3 == "8" | CONTSUB4 == "2" | CONTSUB4 == "3" | CONTSUB4 == "4" | CONTSUB4 == "5" | CONTSUB4 == "8" | CONTSUB5 == "2" | CONTSUB5 == "3" | CONTSUB5 == "4" | CONTSUB5 == "5" | CONTSUB5 == "8" | CONTSUB6 == "2" | CONTSUB6 == "3" | CONTSUB6 == "4" | CONTSUB6 == "5" | CONTSUB6 == "8" | CONTSUB7 == "2" | CONTSUB7 == "3" | CONTSUB7 == "4" | CONTSUB7 == "5" | CONTSUB7 == "8" | CONTSUB8 == "2" | CONTSUB8 == "3" | CONTSUB8 == "4" | CONTSUB8 == "5" | CONTSUB8 == "8")

thirteen_clean <- thirteen %>%
  select(PHYCODE, PATCODE, SENBEFOR, RFV1, RFV2, RFV3, CONTSUB1, CONTSUB2, CONTSUB3, CONTSUB4, CONTSUB5, CONTSUB6, CONTSUB7, CONTSUB8, MED1, MED2, MED3, MED4, MED5, MED6, MED7, MED8, NCMED1, NCMED2, NCMED3, NCMED4, NCMED5, NCMED6, NCMED7, NCMED8) %>%
  filter(CONTSUB1 == "2" | CONTSUB1 == "3" | CONTSUB1 == "4" | CONTSUB1 == "5" | CONTSUB1 == "8" | CONTSUB2 == "2" | CONTSUB2 == "3" | CONTSUB2 == "4" | CONTSUB2 == "5" | CONTSUB2 == "8" | CONTSUB3 == "2" | CONTSUB3 == "3" | CONTSUB3 == "4" | CONTSUB3 == "5" | CONTSUB3 == "8" | CONTSUB4 == "2" | CONTSUB4 == "3" | CONTSUB4 == "4" | CONTSUB4 == "5" | CONTSUB4 == "8" | CONTSUB5 == "2" | CONTSUB5 == "3" | CONTSUB5 == "4" | CONTSUB5 == "5" | CONTSUB5 == "8" | CONTSUB6 == "2" | CONTSUB6 == "3" | CONTSUB6 == "4" | CONTSUB6 == "5" | CONTSUB6 == "8" | CONTSUB7 == "2" | CONTSUB7 == "3" | CONTSUB7 == "4" | CONTSUB7 == "5" | CONTSUB7 == "8" | CONTSUB8 == "2" | CONTSUB8 == "3" | CONTSUB8 == "4" | CONTSUB8 == "5" | CONTSUB8 == "8")

fourteen_clean <- fourteen %>%
  select(PHYCODE, PATCODE, SENBEFOR, RFV1, RFV2, RFV3, CONTSUB1, CONTSUB2, CONTSUB3, CONTSUB4, CONTSUB5, CONTSUB6, CONTSUB7, CONTSUB8, MED1, MED2, MED3, MED4, MED5, MED6, MED7, MED8, NCMED1, NCMED2, NCMED3, NCMED4, NCMED5, NCMED6, NCMED7, NCMED8) %>%
  filter(CONTSUB1 == "2" | CONTSUB1 == "3" | CONTSUB1 == "4" | CONTSUB1 == "5" | CONTSUB1 == "8" | CONTSUB2 == "2" | CONTSUB2 == "3" | CONTSUB2 == "4" | CONTSUB2 == "5" | CONTSUB2 == "8" | CONTSUB3 == "2" | CONTSUB3 == "3" | CONTSUB3 == "4" | CONTSUB3 == "5" | CONTSUB3 == "8" | CONTSUB4 == "2" | CONTSUB4 == "3" | CONTSUB4 == "4" | CONTSUB4 == "5" | CONTSUB4 == "8" | CONTSUB5 == "2" | CONTSUB5 == "3" | CONTSUB5 == "4" | CONTSUB5 == "5" | CONTSUB5 == "8" | CONTSUB6 == "2" | CONTSUB6 == "3" | CONTSUB6 == "4" | CONTSUB6 == "5" | CONTSUB6 == "8" | CONTSUB7 == "2" | CONTSUB7 == "3" | CONTSUB7 == "4" | CONTSUB7 == "5" | CONTSUB7 == "8" | CONTSUB8 == "2" | CONTSUB8 == "3" | CONTSUB8 == "4" | CONTSUB8 == "5" | CONTSUB8 == "8")

fifteen_clean <- fifteen %>%
  select(PHYCODE, PATCODE, SENBEFOR, RFV1, RFV2, RFV3, CONTSUB1, CONTSUB2, CONTSUB3, CONTSUB4, CONTSUB5, CONTSUB6, CONTSUB7, CONTSUB8, MED1, MED2, MED3, MED4, MED5, MED6, MED7, MED8, NCMED1, NCMED2, NCMED3, NCMED4, NCMED5, NCMED6, NCMED7, NCMED8) %>%
  filter(CONTSUB1 == "2" | CONTSUB1 == "3" | CONTSUB1 == "4" | CONTSUB1 == "5" | CONTSUB1 == "8" | CONTSUB2 == "2" | CONTSUB2 == "3" | CONTSUB2 == "4" | CONTSUB2 == "5" | CONTSUB2 == "8" | CONTSUB3 == "2" | CONTSUB3 == "3" | CONTSUB3 == "4" | CONTSUB3 == "5" | CONTSUB3 == "8" | CONTSUB4 == "2" | CONTSUB4 == "3" | CONTSUB4 == "4" | CONTSUB4 == "5" | CONTSUB4 == "8" | CONTSUB5 == "2" | CONTSUB5 == "3" | CONTSUB5 == "4" | CONTSUB5 == "5" | CONTSUB5 == "8" | CONTSUB6 == "2" | CONTSUB6 == "3" | CONTSUB6 == "4" | CONTSUB6 == "5" | CONTSUB6 == "8" | CONTSUB7 == "2" | CONTSUB7 == "3" | CONTSUB7 == "4" | CONTSUB7 == "5" | CONTSUB7 == "8" | CONTSUB8 == "2" | CONTSUB8 == "3" | CONTSUB8 == "4" | CONTSUB8 == "5" | CONTSUB8 == "8")

sixteen_clean <- sixteen %>%
  select(PHYCODE, PATCODE, SENBEFOR, RFV1, RFV2, RFV3, CONTSUB1, CONTSUB2, CONTSUB3, CONTSUB4, CONTSUB5, CONTSUB6, CONTSUB7, CONTSUB8, MED1, MED2, MED3, MED4, MED5, MED6, MED7, MED8, NCMED1, NCMED2, NCMED3, NCMED4, NCMED5, NCMED6, NCMED7, NCMED8) %>%
  filter(CONTSUB1 == "2" | CONTSUB1 == "3" | CONTSUB1 == "4" | CONTSUB1 == "5" | CONTSUB1 == "8" | CONTSUB2 == "2" | CONTSUB2 == "3" | CONTSUB2 == "4" | CONTSUB2 == "5" | CONTSUB2 == "8" | CONTSUB3 == "2" | CONTSUB3 == "3" | CONTSUB3 == "4" | CONTSUB3 == "5" | CONTSUB3 == "8" | CONTSUB4 == "2" | CONTSUB4 == "3" | CONTSUB4 == "4" | CONTSUB4 == "5" | CONTSUB4 == "8" | CONTSUB5 == "2" | CONTSUB5 == "3" | CONTSUB5 == "4" | CONTSUB5 == "5" | CONTSUB5 == "8" | CONTSUB6 == "2" | CONTSUB6 == "3" | CONTSUB6 == "4" | CONTSUB6 == "5" | CONTSUB6 == "8" | CONTSUB7 == "2" | CONTSUB7 == "3" | CONTSUB7 == "4" | CONTSUB7 == "5" | CONTSUB7 == "8" | CONTSUB8 == "2" | CONTSUB8 == "3" | CONTSUB8 == "4" | CONTSUB8 == "5" | CONTSUB8 == "8")

```

```{r}
fourteen_filter <- fourteen_clean %>%
  filter(RFV1 >= 1100.0 & RFV1 <= 1150.0)
```

```{r}
plot_str()
```