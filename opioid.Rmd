---
title: "opioid"
author: "Keaton Pendergrast"
date: "2/13/2020"
output: html_document
---

```{r}
## set libraries needed
library(tidyverse)
library(foreign)
library(funModeling)
library(Hmisc)
library(DataExplorer)
library(readr)
```

```{r}
#pull in the datasets

urlfile="https://media.githubusercontent.com/media/keatonpendergrast/bfb/master/2007.tsv"

seven <- read.table(url(urlfile), sep = '\t', header = TRUE)

urlfile="https://media.githubusercontent.com/media/keatonpendergrast/bfb/master/2008.tsv"

eight <- read.table(url(urlfile), sep = '\t', header = TRUE)

urlfile="https://media.githubusercontent.com/media/keatonpendergrast/bfb/master/2009.tsv"

nine <- read.table(url(urlfile), sep = '\t', header = TRUE)

urlfile="https://media.githubusercontent.com/media/keatonpendergrast/bfb/master/2010.csv"

ten <- read.csv(url(urlfile))

eleven <- read.dta("/Users/keatonpendergrast/Desktop/302w/project/datasets/2011.dta")
twelve <- read.dta("/Users/keatonpendergrast/Desktop/302w/project/datasets/2012.dta")
thirteen <- read.dta("/Users/keatonpendergrast/Desktop/302w/project/datasets/2013.dta")
fourteen <- read.dta("/Users/keatonpendergrast/Desktop/302w/project/datasets/2014.dta")
fifteen <- read.dta("/Users/keatonpendergrast/Desktop/302w/project/datasets/2015.dta")
sixteen <- read.dta("/Users/keatonpendergrast/Desktop/302w/project/datasets/2016.dta")
```

```{r}
#select for the variables we are interested in
seven_clean <- seven %>%
  select(PHYCODE, PATCODE, SENBEFOR, RFV1, RFV2, RFV3, INJURY, CONTSUB1, CONTSUB2, CONTSUB3, CONTSUB4, CONTSUB5, CONTSUB6, CONTSUB7, CONTSUB8, MED1, MED2, MED3, MED4, MED5, MED6, MED7, MED8, NCMED1, NCMED2, NCMED3, NCMED4, NCMED5, NCMED6, NCMED7, NCMED8) %>%
  filter(CONTSUB1 == "2" | CONTSUB1 == "3" | CONTSUB1 == "4" | CONTSUB1 == "5" | CONTSUB1 == "8" | CONTSUB2 == "2" | CONTSUB2 == "3" | CONTSUB2 == "4" | CONTSUB2 == "5" | CONTSUB2 == "8" | CONTSUB3 == "2" | CONTSUB3 == "3" | CONTSUB3 == "4" | CONTSUB3 == "5" | CONTSUB3 == "8" | CONTSUB4 == "2" | CONTSUB4 == "3" | CONTSUB4 == "4" | CONTSUB4 == "5" | CONTSUB4 == "8" | CONTSUB5 == "2" | CONTSUB5 == "3" | CONTSUB5 == "4" | CONTSUB5 == "5" | CONTSUB5 == "8" | CONTSUB6 == "2" | CONTSUB6 == "3" | CONTSUB6 == "4" | CONTSUB6 == "5" | CONTSUB6 == "8" | CONTSUB7 == "2" | CONTSUB7 == "3" | CONTSUB7 == "4" | CONTSUB7 == "5" | CONTSUB7 == "8" | CONTSUB8 == "2" | CONTSUB8 == "3" | CONTSUB8 == "4" | CONTSUB8 == "5" | CONTSUB8 == "8")
  

eight_clean <- eight %>%
  select(PHYCODE, PATCODE, SENBEFOR, RFV1, RFV2, RFV3, INJURY, CONTSUB1, CONTSUB2, CONTSUB3, CONTSUB4, CONTSUB5, CONTSUB6, CONTSUB7, CONTSUB8, MED1, MED2, MED3, MED4, MED5, MED6, MED7, MED8, NCMED1, NCMED2, NCMED3, NCMED4, NCMED5, NCMED6, NCMED7, NCMED8) %>%
  filter(CONTSUB1 == "2" | CONTSUB1 == "3" | CONTSUB1 == "4" | CONTSUB1 == "5" | CONTSUB1 == "8" | CONTSUB2 == "2" | CONTSUB2 == "3" | CONTSUB2 == "4" | CONTSUB2 == "5" | CONTSUB2 == "8" | CONTSUB3 == "2" | CONTSUB3 == "3" | CONTSUB3 == "4" | CONTSUB3 == "5" | CONTSUB3 == "8" | CONTSUB4 == "2" | CONTSUB4 == "3" | CONTSUB4 == "4" | CONTSUB4 == "5" | CONTSUB4 == "8" | CONTSUB5 == "2" | CONTSUB5 == "3" | CONTSUB5 == "4" | CONTSUB5 == "5" | CONTSUB5 == "8" | CONTSUB6 == "2" | CONTSUB6 == "3" | CONTSUB6 == "4" | CONTSUB6 == "5" | CONTSUB6 == "8" | CONTSUB7 == "2" | CONTSUB7 == "3" | CONTSUB7 == "4" | CONTSUB7 == "5" | CONTSUB7 == "8" | CONTSUB8 == "2" | CONTSUB8 == "3" | CONTSUB8 == "4" | CONTSUB8 == "5" | CONTSUB8 == "8")

nine_clean <- nine %>%
  select(PHYCODE, PATCODE, SENBEFOR, RFV1, RFV2, RFV3, INJURY, CONTSUB1, CONTSUB2, CONTSUB3, CONTSUB4, CONTSUB5, CONTSUB6, CONTSUB7, CONTSUB8, MED1, MED2, MED3, MED4, MED5, MED6, MED7, MED8, NCMED1, NCMED2, NCMED3, NCMED4, NCMED5, NCMED6, NCMED7, NCMED8) %>%
  filter(CONTSUB1 == "2" | CONTSUB1 == "3" | CONTSUB1 == "4" | CONTSUB1 == "5" | CONTSUB1 == "8" | CONTSUB2 == "2" | CONTSUB2 == "3" | CONTSUB2 == "4" | CONTSUB2 == "5" | CONTSUB2 == "8" | CONTSUB3 == "2" | CONTSUB3 == "3" | CONTSUB3 == "4" | CONTSUB3 == "5" | CONTSUB3 == "8" | CONTSUB4 == "2" | CONTSUB4 == "3" | CONTSUB4 == "4" | CONTSUB4 == "5" | CONTSUB4 == "8" | CONTSUB5 == "2" | CONTSUB5 == "3" | CONTSUB5 == "4" | CONTSUB5 == "5" | CONTSUB5 == "8" | CONTSUB6 == "2" | CONTSUB6 == "3" | CONTSUB6 == "4" | CONTSUB6 == "5" | CONTSUB6 == "8" | CONTSUB7 == "2" | CONTSUB7 == "3" | CONTSUB7 == "4" | CONTSUB7 == "5" | CONTSUB7 == "8" | CONTSUB8 == "2" | CONTSUB8 == "3" | CONTSUB8 == "4" | CONTSUB8 == "5" | CONTSUB8 == "8")

ten_clean <- ten %>%
  select(PHYCODE, PATCODE, SENBEFOR, RFV1, RFV2, RFV3, INJURY, CONTSUB1, CONTSUB2, CONTSUB3, CONTSUB4, CONTSUB5, CONTSUB6, CONTSUB7, CONTSUB8, MED1, MED2, MED3, MED4, MED5, MED6, MED7, MED8, NCMED1, NCMED2, NCMED3, NCMED4, NCMED5, NCMED6, NCMED7, NCMED8) %>%
  filter(CONTSUB1 == "2" | CONTSUB1 == "3" | CONTSUB1 == "4" | CONTSUB1 == "5" | CONTSUB1 == "8" | CONTSUB2 == "2" | CONTSUB2 == "3" | CONTSUB2 == "4" | CONTSUB2 == "5" | CONTSUB2 == "8" | CONTSUB3 == "2" | CONTSUB3 == "3" | CONTSUB3 == "4" | CONTSUB3 == "5" | CONTSUB3 == "8" | CONTSUB4 == "2" | CONTSUB4 == "3" | CONTSUB4 == "4" | CONTSUB4 == "5" | CONTSUB4 == "8" | CONTSUB5 == "2" | CONTSUB5 == "3" | CONTSUB5 == "4" | CONTSUB5 == "5" | CONTSUB5 == "8" | CONTSUB6 == "2" | CONTSUB6 == "3" | CONTSUB6 == "4" | CONTSUB6 == "5" | CONTSUB6 == "8" | CONTSUB7 == "2" | CONTSUB7 == "3" | CONTSUB7 == "4" | CONTSUB7 == "5" | CONTSUB7 == "8" | CONTSUB8 == "2" | CONTSUB8 == "3" | CONTSUB8 == "4" | CONTSUB8 == "5" | CONTSUB8 == "8")

eleven_clean <- eleven %>%
  select(PHYCODE, PATCODE, SENBEFOR, RFV1, RFV2, RFV3, INJURY, CONTSUB1, CONTSUB2, CONTSUB3, CONTSUB4, CONTSUB5, CONTSUB6, CONTSUB7, CONTSUB8, MED1, MED2, MED3, MED4, MED5, MED6, MED7, MED8, NCMED1, NCMED2, NCMED3, NCMED4, NCMED5, NCMED6, NCMED7, NCMED8) %>%
  filter(CONTSUB1 == "Schedule II" | CONTSUB1 == "Schedule III" | CONTSUB1 == "Schedule IV" | CONTSUB1 == "Schedule V" | CONTSUB1 == "Multiple schedules" | CONTSUB2 == "Schedule II" | CONTSUB2 == "Schedule III" | CONTSUB2 == "Schedule IV" | CONTSUB2 == "Schedule IV" | CONTSUB2 == "Multiple schedules" | CONTSUB3 == "Schedule II" | CONTSUB3 == "Schedule III" | CONTSUB3 == "Schedule IV" | CONTSUB3 == "Schedule V" | CONTSUB3 == "Multiple schedules" | CONTSUB4 == "Schedule II" | CONTSUB4 == "Schedule III" | CONTSUB4 == "Schedule IV" | CONTSUB4 == "Schedule V" | CONTSUB4 == "Multiple schedules" | CONTSUB5 == "Schedule II" | CONTSUB5 == "Schedule III" | CONTSUB5 == "Schedule IV" | CONTSUB5 == "Schedule V" | CONTSUB5 == "Multiple schedules" | CONTSUB6 == "Schedule II" | CONTSUB6 == "Schedule II" | CONTSUB6 == "Schedule IV" | CONTSUB6 == "Schedule V" | CONTSUB6 == "Multiple schedules" | CONTSUB7 == "Schedule II" | CONTSUB7 == "Schedule III" | CONTSUB7 == "Schedule IV" | CONTSUB7 == "Schedule V" | CONTSUB7 == "Multiple schedules" | CONTSUB8 == "Schedule II" | CONTSUB8 == "Schedule III" | CONTSUB8 == "Schedule IV" | CONTSUB8 == "Schedule V" | CONTSUB8 == "Multiple schedules")

twelve_clean <- twelve %>%
  select(PHYCODE, PATCODE, SENBEFOR, RFV1, RFV2, RFV3, INJURY, CONTSUB1, CONTSUB2, CONTSUB3, CONTSUB4, CONTSUB5, CONTSUB6, CONTSUB7, CONTSUB8, MED1, MED2, MED3, MED4, MED5, MED6, MED7, MED8, NCMED1, NCMED2, NCMED3, NCMED4, NCMED5, NCMED6, NCMED7, NCMED8) %>%
  filter(CONTSUB1 == "Schedule II" | CONTSUB1 == "Schedule III" | CONTSUB1 == "Schedule IV" | CONTSUB1 == "Schedule V" | CONTSUB1 == "Multiple schedules" | CONTSUB2 == "Schedule II" | CONTSUB2 == "Schedule III" | CONTSUB2 == "Schedule IV" | CONTSUB2 == "Schedule IV" | CONTSUB2 == "Multiple schedules" | CONTSUB3 == "Schedule II" | CONTSUB3 == "Schedule III" | CONTSUB3 == "Schedule IV" | CONTSUB3 == "Schedule V" | CONTSUB3 == "Multiple schedules" | CONTSUB4 == "Schedule II" | CONTSUB4 == "Schedule III" | CONTSUB4 == "Schedule IV" | CONTSUB4 == "Schedule V" | CONTSUB4 == "Multiple schedules" | CONTSUB5 == "Schedule II" | CONTSUB5 == "Schedule III" | CONTSUB5 == "Schedule IV" | CONTSUB5 == "Schedule V" | CONTSUB5 == "Multiple schedules" | CONTSUB6 == "Schedule II" | CONTSUB6 == "Schedule II" | CONTSUB6 == "Schedule IV" | CONTSUB6 == "Schedule V" | CONTSUB6 == "Multiple schedules" | CONTSUB7 == "Schedule II" | CONTSUB7 == "Schedule III" | CONTSUB7 == "Schedule IV" | CONTSUB7 == "Schedule V" | CONTSUB7 == "Multiple schedules" | CONTSUB8 == "Schedule II" | CONTSUB8 == "Schedule III" | CONTSUB8 == "Schedule IV" | CONTSUB8 == "Schedule V" | CONTSUB8 == "Multiple schedules")

thirteen_clean <- thirteen %>%
  select(PHYCODE, PATCODE, SENBEFOR, RFV1, RFV2, RFV3, INJURY, CONTSUB1, CONTSUB2, CONTSUB3, CONTSUB4, CONTSUB5, CONTSUB6, CONTSUB7, CONTSUB8, MED1, MED2, MED3, MED4, MED5, MED6, MED7, MED8, NCMED1, NCMED2, NCMED3, NCMED4, NCMED5, NCMED6, NCMED7, NCMED8) %>%
  filter(CONTSUB1 == "Schedule II" | CONTSUB1 == "Schedule III" | CONTSUB1 == "Schedule IV" | CONTSUB1 == "Schedule V" | CONTSUB1 == "Multiple schedules" | CONTSUB2 == "Schedule II" | CONTSUB2 == "Schedule III" | CONTSUB2 == "Schedule IV" | CONTSUB2 == "Schedule IV" | CONTSUB2 == "Multiple schedules" | CONTSUB3 == "Schedule II" | CONTSUB3 == "Schedule III" | CONTSUB3 == "Schedule IV" | CONTSUB3 == "Schedule V" | CONTSUB3 == "Multiple schedules" | CONTSUB4 == "Schedule II" | CONTSUB4 == "Schedule III" | CONTSUB4 == "Schedule IV" | CONTSUB4 == "Schedule V" | CONTSUB4 == "Multiple schedules" | CONTSUB5 == "Schedule II" | CONTSUB5 == "Schedule III" | CONTSUB5 == "Schedule IV" | CONTSUB5 == "Schedule V" | CONTSUB5 == "Multiple schedules" | CONTSUB6 == "Schedule II" | CONTSUB6 == "Schedule II" | CONTSUB6 == "Schedule IV" | CONTSUB6 == "Schedule V" | CONTSUB6 == "Multiple schedules" | CONTSUB7 == "Schedule II" | CONTSUB7 == "Schedule III" | CONTSUB7 == "Schedule IV" | CONTSUB7 == "Schedule V" | CONTSUB7 == "Multiple schedules" | CONTSUB8 == "Schedule II" | CONTSUB8 == "Schedule III" | CONTSUB8 == "Schedule IV" | CONTSUB8 == "Schedule V" | CONTSUB8 == "Multiple schedules")

fourteen_clean <- fourteen %>%
  select(PHYCODE, PATCODE, SENBEFOR, RFV1, RFV2, RFV3, INJURY, CONTSUB1, CONTSUB2, CONTSUB3, CONTSUB4, CONTSUB5, CONTSUB6, CONTSUB7, CONTSUB8, MED1, MED2, MED3, MED4, MED5, MED6, MED7, MED8, NCMED1, NCMED2, NCMED3, NCMED4, NCMED5, NCMED6, NCMED7, NCMED8) %>%
  filter(CONTSUB1 == "Schedule II" | CONTSUB1 == "Schedule III" | CONTSUB1 == "Schedule IV" | CONTSUB1 == "Schedule V" | CONTSUB1 == "Multiple schedules" | CONTSUB2 == "Schedule II" | CONTSUB2 == "Schedule III" | CONTSUB2 == "Schedule IV" | CONTSUB2 == "Schedule IV" | CONTSUB2 == "Multiple schedules" | CONTSUB3 == "Schedule II" | CONTSUB3 == "Schedule III" | CONTSUB3 == "Schedule IV" | CONTSUB3 == "Schedule V" | CONTSUB3 == "Multiple schedules" | CONTSUB4 == "Schedule II" | CONTSUB4 == "Schedule III" | CONTSUB4 == "Schedule IV" | CONTSUB4 == "Schedule V" | CONTSUB4 == "Multiple schedules" | CONTSUB5 == "Schedule II" | CONTSUB5 == "Schedule III" | CONTSUB5 == "Schedule IV" | CONTSUB5 == "Schedule V" | CONTSUB5 == "Multiple schedules" | CONTSUB6 == "Schedule II" | CONTSUB6 == "Schedule II" | CONTSUB6 == "Schedule IV" | CONTSUB6 == "Schedule V" | CONTSUB6 == "Multiple schedules" | CONTSUB7 == "Schedule II" | CONTSUB7 == "Schedule III" | CONTSUB7 == "Schedule IV" | CONTSUB7 == "Schedule V" | CONTSUB7 == "Multiple schedules" | CONTSUB8 == "Schedule II" | CONTSUB8 == "Schedule III" | CONTSUB8 == "Schedule IV" | CONTSUB8 == "Schedule V" | CONTSUB8 == "Multiple schedules")

fifteen_clean <- fifteen %>%
  select(PHYCODE, PATCODE, SENBEFOR, RFV1, RFV2, RFV3, INJURY, CONTSUB1, CONTSUB2, CONTSUB3, CONTSUB4, CONTSUB5, CONTSUB6, CONTSUB7, CONTSUB8, MED1, MED2, MED3, MED4, MED5, MED6, MED7, MED8, NCMED1, NCMED2, NCMED3, NCMED4, NCMED5, NCMED6, NCMED7, NCMED8) %>%
  filter(CONTSUB1 == "Schedule II" | CONTSUB1 == "Schedule III" | CONTSUB1 == "Schedule IV" | CONTSUB1 == "Schedule V" | CONTSUB1 == "Multiple schedules" | CONTSUB2 == "Schedule II" | CONTSUB2 == "Schedule III" | CONTSUB2 == "Schedule IV" | CONTSUB2 == "Schedule IV" | CONTSUB2 == "Multiple schedules" | CONTSUB3 == "Schedule II" | CONTSUB3 == "Schedule III" | CONTSUB3 == "Schedule IV" | CONTSUB3 == "Schedule V" | CONTSUB3 == "Multiple schedules" | CONTSUB4 == "Schedule II" | CONTSUB4 == "Schedule III" | CONTSUB4 == "Schedule IV" | CONTSUB4 == "Schedule V" | CONTSUB4 == "Multiple schedules" | CONTSUB5 == "Schedule II" | CONTSUB5 == "Schedule III" | CONTSUB5 == "Schedule IV" | CONTSUB5 == "Schedule V" | CONTSUB5 == "Multiple schedules" | CONTSUB6 == "Schedule II" | CONTSUB6 == "Schedule II" | CONTSUB6 == "Schedule IV" | CONTSUB6 == "Schedule V" | CONTSUB6 == "Multiple schedules" | CONTSUB7 == "Schedule II" | CONTSUB7 == "Schedule III" | CONTSUB7 == "Schedule IV" | CONTSUB7 == "Schedule V" | CONTSUB7 == "Multiple schedules" | CONTSUB8 == "Schedule II" | CONTSUB8 == "Schedule III" | CONTSUB8 == "Schedule IV" | CONTSUB8 == "Schedule V" | CONTSUB8 == "Multiple schedules")

sixteen_clean <- sixteen %>%
  select(PHYCODE, PATCODE, SENBEFOR, RFV1, RFV2, RFV3, INJURY, CONTSUB1, CONTSUB2, CONTSUB3, CONTSUB4, CONTSUB5, CONTSUB6, CONTSUB7, CONTSUB8, MED1, MED2, MED3, MED4, MED5, MED6, MED7, MED8, NCMED1, NCMED2, NCMED3, NCMED4, NCMED5, NCMED6, NCMED7, NCMED8) %>%
  filter(CONTSUB1 == "Schedule II" | CONTSUB1 == "Schedule III" | CONTSUB1 == "Schedule IV" | CONTSUB1 == "Schedule V" | CONTSUB1 == "Multiple schedules" | CONTSUB2 == "Schedule II" | CONTSUB2 == "Schedule III" | CONTSUB2 == "Schedule IV" | CONTSUB2 == "Schedule IV" | CONTSUB2 == "Multiple schedules" | CONTSUB3 == "Schedule II" | CONTSUB3 == "Schedule III" | CONTSUB3 == "Schedule IV" | CONTSUB3 == "Schedule V" | CONTSUB3 == "Multiple schedules" | CONTSUB4 == "Schedule II" | CONTSUB4 == "Schedule III" | CONTSUB4 == "Schedule IV" | CONTSUB4 == "Schedule V" | CONTSUB4 == "Multiple schedules" | CONTSUB5 == "Schedule II" | CONTSUB5 == "Schedule III" | CONTSUB5 == "Schedule IV" | CONTSUB5 == "Schedule V" | CONTSUB5 == "Multiple schedules" | CONTSUB6 == "Schedule II" | CONTSUB6 == "Schedule II" | CONTSUB6 == "Schedule IV" | CONTSUB6 == "Schedule V" | CONTSUB6 == "Multiple schedules" | CONTSUB7 == "Schedule II" | CONTSUB7 == "Schedule III" | CONTSUB7 == "Schedule IV" | CONTSUB7 == "Schedule V" | CONTSUB7 == "Multiple schedules" | CONTSUB8 == "Schedule II" | CONTSUB8 == "Schedule III" | CONTSUB8 == "Schedule IV" | CONTSUB8 == "Schedule V" | CONTSUB8 == "Multiple schedules")
```

```{r}
plot_str(sixteen_clean)
```